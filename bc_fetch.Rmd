Breast Cancer QA Part 1: Fetch Data Files
=========================================

Data files were submitted to redcap:
 - [GPC Breast Cancer Project 1: review of survey population][4044]

[4044]: https://redcap.kumc.edu/redcap_v5.7.7/index.php?pid=4044

*Transformation and access utilities:*

```{r}
source('bc_qa_txform.R')
```

We fetch all the survey and CRF data from that project as well as the submitted data files:

```{r}
getKey <- source('bcread_api_key.R')

runDir <- getwd()

setwd("~/projects/bc_qa/data-files")
# get rid of existing data files
system("rm *")
dataDir <- getwd()
got <- bc_access(getKey, src=runDir, pyenv='/home/dconnolly/pyenv/bcqa')

setwd(runDir)
```

We have data on submitter and (index of) institution, as well as which submissions are obsolete:

```{r}
submission <- read.csv(textConnection(got$formdata),
                       row.names='record_id',
                       stringsAsFactors=FALSE)
submission[,c('name', 'institution', 'obsolete')]
```


And we have basic info about the data files:

```{r}
grep('patients', got$normalizelog, value=TRUE)
```

*TODO: save file sizes?*

Save our work for use in later articles:

```{r}
save(dataDir, got, submission, file="bc_download.RData")
```
